<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Новогодние песни</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"/>
    <style>
        /* Общие стили */
        body {
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            background-image: linear-gradient(120deg, #a1c4fd 0%, #c2e9fb 100%);
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        .player {
            background-color: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            text-align: center;
            margin-bottom: 20px;
            max-width: 350px;
            width: 100%;
            box-sizing: border-box;
        }

        /* Стили для контролов плеера */
        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }

        .controls button {
            background: none;
            border: none;
            padding: 10px;
            cursor: pointer;
            font-size: 20px;
            margin: 0 10px;
        }

        .controls button:focus {
            outline: none;
        }

        .controls i {
            pointer-events: none;
        }

        /* Стили для ползунка прогресса */
         input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            max-width: 300px;
            height: 5px;
            background: #ddd;
            outline: none;
            border-radius: 5px;
            margin-top: 10px;
        }

        /* Стиль для линии заполнения в WebKit-браузерах */
        input[type="range"]::-webkit-slider-runnable-track {
            background: #ddd;
            height: 5px;
            border-radius: 5px;
            position: relative;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
            position: relative;
            z-index: 2; /* Чтобы ползунок был поверх линии */
        }

        /* Стиль для линии заполнения в Firefox */
        input[type="range"]::-moz-range-track {
            background: #ddd;
            height: 5px;
            border-radius: 5px;
            position: relative;
        }

        input[type="range"]::-moz-range-thumb {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
            position: relative;
            z-index: 2;  /* Чтобы ползунок был поверх линии */
        }
         /* Стиль для линии заполнения */
         input[type="range"]::-webkit-slider-runnable-track::before{
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            background-color: #4CAF50;
            border-radius: 5px;
            width: var(--range-progress, 0%);
         }

         input[type="range"]::-moz-range-track::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            background-color: #4CAF50;
            border-radius: 5px;
             width: var(--range-progress, 0%);
         }


        /* Стили Swiper */
        .swiper {
            width: 240px;
            height: 240px;
            margin: 0 auto;
        }

        .swiper-slide {
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 18px;
            font-size: 22px;
            font-weight: bold;
            color: #fff;
            background-color: #ccc;
        }

        .swiper-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .swiper-slide:nth-child(3n) {
            background-color: rgb(10, 184, 111);
        }
        .swiper-slide:nth-child(6n) {
            background-color: rgb(180, 10, 47);
        }

        .swiper-slide:nth-child(7n) {
            background-color: rgb(35, 99, 19);
        }

        .swiper-slide:nth-child(8n) {
            background-color: rgb(0, 68, 255);
        }

        .swiper-slide:nth-child(9n) {
            background-color: rgb(218, 12, 218);
        }

        .swiper-slide:nth-child(10n) {
            background-color: rgb(54, 94, 77);
        }

        /* Стили для списка треков */
        .track-list {
            text-align: left;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
        }

        .track-list a {
            display: block;
            padding: 8px 0;
            text-decoration: none;
            color: #333;
        }

        .track-list a:hover {
            text-decoration: underline;
            color: #4CAF50;
        }

        .track-list a.active {
            color: #4CAF50;
            font-weight: bold;
        }

         /* Адаптивность для маленьких экранов */
        @media (max-width: 480px) {
            .swiper {
                width: 200px;
                height: 200px;
            }
            .player {
                padding: 15px;
            }
            .controls button {
                padding: 8px;
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
<div class="player">
    <div class="swiper mySwiper">
        <div class="swiper-wrapper">
            <div class="swiper-slide" data-hash="slide1" data-track="https://new-years-songs.onrender.com/Music/SVV2Y-P3H4W.mp3">
                <img src="./Image/SVV2Y-P3H4W.png" alt="Slide 1"/>
            </div>
            <div class="swiper-slide" data-hash="slide2" data-track="https://new-years-songs.onrender.com/Music/TJY78-YQ28A.mp3">
                <img src="./Image/TJY78-YQ28A.png" alt="Slide 2"/>
            </div>
            <div class="swiper-slide" data-hash="slide3" data-track="https://new-years-songs.onrender.com/Music/WMVCZ-VE9GQ.mp3">
                <img src="./Image/WMVCZ-VE9GQ.png" alt="Slide 3"/>
            </div>
            <div class="swiper-slide" data-hash="slide4" data-track="https://new-years-songs.onrender.com/Music/Q6KQB-LAKQS.mp3">
                <img src="./Image/Q6KQB-LAKQS.png" alt="Slide 4"/>
            </div>
            <div class="swiper-slide" data-hash="slide5" data-track="https://new-years-songs.onrender.com/Music/RS8Y4-WU98C.mp3">
                <img src="./Image/RS8Y4-WU98C.png" alt="Slide 5"/>
            </div>
            <div class="swiper-slide" data-hash="slide6" data-track="https://new-years-songs.onrender.com/Music/AEJ7C-6897L.mp3">
                <img src="./Image/AEJ7C-6897L.png" alt="Slide 6"/>
            </div>
            <div class="swiper-slide" data-hash="slide7" data-track="https://new-years-songs.onrender.com/Music/4R799-TA4ZH.mp3">
                <img src="./Image/4R799-TA4ZH.png" alt="Slide 7"/>
            </div>
            <div class="swiper-slide" data-hash="slide8" data-track="https://new-years-songs.onrender.com/Music/S6Q8Y-M1H2P.mp3">Slide 8</div>
            <div class="swiper-slide" data-hash="slide9" data-track="https://new-years-songs.onrender.com/Music/T3Z5B-Q9L2R.mp3">Slide 9</div>
            <div class="swiper-slide" data-hash="slide10" data-track="https://new-years-songs.onrender.com/Music/V9N7C-J4X6S.mp3">Slide 10</div>
            <div class="swiper-slide" data-hash="slide11" data-track="https://new-years-songs.onrender.com/Music/W4F1G-K8H9P.mp3">Slide 11</div>
            <div class="swiper-slide" data-hash="slide12" data-track="https://new-years-songs.onrender.com/Music/X7B2J-N3Y5M.mp3">Slide 12</div>
            <div class="swiper-slide" data-hash="slide13" data-track="https://new-years-songs.onrender.com/Music/Y9L3R-C4V7B.mp3">Slide 13</div>
            <div class="swiper-slide" data-hash="slide14" data-track="https://new-years-songs.onrender.com/Music/Z2K6P-D1N9S.mp3">Slide 14</div>
            <div class="swiper-slide" data-hash="slide15" data-track="https://new-years-songs.onrender.com/Music/A3H4X-T9R1W.mp3">Slide 15</div>
            <div class="swiper-slide" data-hash="slide16" data-track="https://new-years-songs.onrender.com/Music/B7F5V-P2J8G.mp3">Slide 16</div>
            <div class="swiper-slide" data-hash="slide17" data-track="https://new-years-songs.onrender.com/Music/C1Y9M-Q4L2K.mp3">Slide 17</div>
            <div class="swiper-slide" data-hash="slide18" data-track="https://new-years-songs.onrender.com/Music/D6R8Z-S3X9C.mp3">Slide 18</div>
            <div class="swiper-slide" data-hash="slide19" data-track="https://new-years-songs.onrender.com/Music/E5V3B-J7N1P.mp3">Slide 19</div>
            <div class="swiper-slide" data-hash="slide20" data-track="https://new-years-songs.onrender.com/Music/F4C2K-G9H7Y.mp3">Slide 20</div>
        </div>
    </div>
    <audio id="audio" preload="metadata"></audio>
    <div class="controls">
        <button id="prevButton" onclick="prevSlide()"><i class="fa fa-backward"></i></button>
        <button id="playPauseButton" onclick="togglePlayPause()">
            <i id="playPauseIcon" class="fa fa-play"></i>
        </button>
        <button id="nextButton" onclick="nextSlide()"><i class="fa fa-forward"></i></button>
    </div>
    <input type="range" id="progress" value="0" max="100">
    <div class="track-list">
        <a href="#" data-hash="slide1">Кабы не было зимы</a>
        <a href="#" data-hash="slide2">Зимняя сказка</a>
        <a href="#" data-hash="slide3">Новый год</a>
        <a href="#" data-hash="slide4">Что такое новый год?</a>
        <a href="#" data-hash="slide5">Новогодние колокольчики</a>
        <a href="#" data-hash="slide6">Новый год у ворот</a>
        <a href="#" data-hash="slide8">Track 8</a>
        <a href="#" data-hash="slide9">Track 9</a>
        <a href="#" data-hash="slide10">Track 10</a>
        <a href="#" data-hash="slide11">Track 11</a>
        <a href="#" data-hash="slide12">Track 12</a>
        <a href="#" data-hash="slide13">Track 13</a>
        <a href="#" data-hash="slide14">Track 14</a>
        <a href="#" data-hash="slide15">Track 15</a>
        <a href="#" data-hash="slide16">Track 16</a>
        <a href="#" data-hash="slide17">Track 17</a>
        <a href="#" data-hash="slide18">Track 18</a>
        <a href="#" data-hash="slide19">Track 19</a>
        <a href="#" data-hash="slide20">Track 20</a>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
    // Audio player script
    const audio = document.getElementById('audio');
    const playPauseButton = document.getElementById('playPauseButton');
    const playPauseIcon = document.getElementById('playPauseIcon');
    const progress = document.getElementById('progress');
    const trackLinks = document.querySelectorAll('.track-list a');
    let currentTrack = null;
    let swiper;

    // Функция для переключения воспроизведения
    function togglePlayPause() {
        if (audio.paused) {
            audio.play();
            playPauseIcon.classList.remove('fa-play');
            playPauseIcon.classList.add('fa-pause');
        } else {
            audio.pause();
            playPauseIcon.classList.remove('fa-pause');
            playPauseIcon.classList.add('fa-play');
        }
    }

    // Обновление прогресса
    audio.addEventListener('timeupdate', () => {
         const percentage = (audio.currentTime / audio.duration) * 100;
          progress.value = percentage;
        progress.style.setProperty('--range-progress', `${percentage}%`);
    });

    // Перемотка трека
    progress.addEventListener('input', () => {
        const seekTime = (progress.value / 100) * audio.duration;
        audio.currentTime = seekTime;
        progress.style.setProperty('--range-progress', `${progress.value}%`);
    });

    // Сброс трека по окончанию
    audio.addEventListener('ended', () => {
         playPauseIcon.classList.remove('fa-pause');
        playPauseIcon.classList.add('fa-play');
        progress.value = 0;
        audio.currentTime = 0;
        progress.style.setProperty('--range-progress', `0%`);
    });

    // Переход к предыдущему слайду
    function prevSlide() {
        swiper.slidePrev();
        updateTrackBySlide();
    }

    // Переход к следующему слайду
    function nextSlide() {
        swiper.slideNext();
        updateTrackBySlide();
    }
    // Установка активного трека в списке
     function setActiveTrack(track) {
         trackLinks.forEach(link => link.classList.remove('active'));
            if(track){
                 track.classList.add('active');
            }
    }

    // Обновление трека при переключении слайда
   function updateTrackBySlide() {
        const activeSlide = swiper.slides[swiper.activeIndex];
        if (!activeSlide) return;

        const trackUrl = activeSlide.dataset.track;
        const hash = activeSlide.dataset.hash;

         if(trackUrl){
             if (trackUrl !== audio.src) {
                 audio.src = trackUrl;
                audio.currentTime = 0;
                 progress.value = 0;
                 progress.style.setProperty('--range-progress', `0%`);
                audio.play();
            } else if (audio.paused) {
                  audio.play();
            }
             currentTrack = Array.from(trackLinks).find(link => link.dataset.hash === hash);
                 setActiveTrack(currentTrack);
                  playPauseIcon.classList.remove('fa-play');
                  playPauseIcon.classList.add('fa-pause');
         }else{
              setActiveTrack(null)
         }
    }


    // Обработка кликов по списку треков
     trackLinks.forEach(link => {
        link.addEventListener('click', function (event) {
            event.preventDefault();
            const hash = this.dataset.hash;
            swiper.slideTo(Array.from(swiper.slides).findIndex(slide => slide.dataset.hash === hash))
             updateTrackBySlide();
        });
    });

    // Обработчик изменения hash
    window.addEventListener('hashchange', function() {
         const currentHash = window.location.hash.substring(1) || 'slide1';
         const slideIndex = Array.from(swiper.slides).findIndex(slide => slide.dataset.hash === currentHash);
         if(slideIndex !== -1) {
             swiper.slideTo(slideIndex);
             updateTrackBySlide();
        }
    });

   // Инициализация Swiper и начальная настройка
    document.addEventListener("DOMContentLoaded", function() {
       swiper = new Swiper(".mySwiper", {
            effect: "cards",
             grabCursor: true,
            pagination: {
               el: ".swiper-pagination",
                clickable: true,
            },
            hashNavigation: {
                watchState: true,
            },
       });
        if (window.location.hash) {
            const currentHash = window.location.hash.substring(1);
            const slideIndex = Array.from(swiper.slides).findIndex(slide => slide.dataset.hash === currentHash);
            if(slideIndex !== -1){
               swiper.slideTo(slideIndex);
                updateTrackBySlide();
           }
         }else{
            updateTrackBySlide();
        }

    });
</script>
</body>
</html>